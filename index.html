<!DOCTYPE html>
<html>
<script src="realtime.Sugar.js"></script>
  <head>
    <title>Hive Project-  version 1</title>

    <!-- Load Styles -->
    <link href="https://www.gstatic.com/realtime/quickstart-styles.css" rel="stylesheet" type="text/css"/>

    <!-- Load the Realtime JavaScript library -->
  </head>
  <body>
    <main>
      <h1>Hive Project</h1>
      <p>Now that your application is running, simply type in either text box and see your changes instantly appear in the other one. Open
      this same document in a <a onclick="window.open(window.location.href);return false;" target="_blank">new tab</a> to see it work across tabs.</p>
      <textarea id="text_area_1"></textarea> 
      <button id="auth_button">Authorize</button>
    </main>
    <script>
	
	function setButton(){
	        var button = document.getElementById('auth_button');
            button.classList.add('visible');
            button.addEventListener('click', authorize);
	}
	function unSetButton(){
	
	        var button = document.getElementById('auth_button');
            button.classList.remove('visible');
            
	}
      function authorize() {
        // Attempt to authorize
        realtimeUtils.authorize(function(response){
          if(response.error){
            // Authorization failed because this is the first time the user has used your application,
            // show the authorize button to prompt them to authorize manually.
				setButton();
            }
           else {
              start(wireTextBoxes);
			  unSetButton();
          }
        });} 
setButton();

      // Connects the text boxes to the collaborative string
      function wireTextBoxes(model) {
	  
		var collaborativeString =model.getRoot().get('demo_string');
        var textArea1 = document.getElementById('text_area_1'); 
        gapi.drive.realtime.databinding.bindString(collaborativeString, textArea1); 
      }
    </script>
  </body>
</html>